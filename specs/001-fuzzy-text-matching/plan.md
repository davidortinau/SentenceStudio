# Implementation Plan: Fuzzy Text Matching for Vocabulary Quiz

**Branch**: `001-fuzzy-text-matching` | **Date**: 2025-12-14 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-fuzzy-text-matching/spec.md`

**Note**: This plan was generated by the `/speckit.plan` command workflow.

## Summary

Implement fuzzy text matching for vocabulary quiz text entry answers to accept core words without requiring exact annotation formatting. Uses regex-based normalization (removing parentheses, tildes, punctuation) and bidirectional infinitive matching ("choose" ↔ "to choose") to reduce false negatives while maintaining zero false positives. Evaluation happens client-side in <1ms using compiled regex patterns, works offline on all platforms.

## Technical Context

<!--
  ACTION REQUIRED: Replace the content in this section with the technical details
  for the project. The structure here is presented in advisory capacity to guide
  the iteration process.
-->

**Language/Version**: .NET 10.0 (net10.0-android, net10.0-ios, net10.0-maccatalyst, net10.0-windows10.0.19041.0)  
**Primary Dependencies**: .NET MAUI 10.0.20+, MauiReactor, SQLite, Microsoft.Extensions.AI, ElevenLabs SDK  
**Storage**: SQLite local database with optional CoreSync synchronization  
**Testing**: xUnit for unit tests, platform-specific testing for UI  
**Target Platform**: iOS 12.2+, Android API 21+, macOS 15.0+, Windows 10.0.17763.0+  
**Project Type**: Multi-platform MAUI application (mobile + desktop)  
**Performance Goals**: <3s startup, <100ms UI response, <500ms AI API calls with loading indicators  
**Constraints**: Must work offline, all platforms tested, ILogger for production logs, Theme-first styling  
**Scale/Scope**: Single-user language learning app with custom curriculum support

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

Verify alignment with SentenceStudio Constitution (`.specify/memory/constitution.md`):

- [x] **User-Centric AI-Powered Learning**: ✅ Improves learning experience by reducing false negatives when users know core vocabulary but forget annotation formatting
- [x] **Cross-Platform Native**: ✅ Pure .NET string/regex operations work identically on iOS, Android, macOS, and Windows; no platform-specific code needed
- [x] **MauiReactor MVU**: ✅ No UI changes required (evaluation logic only); existing page uses semantic methods correctly
- [x] **Theme-First UI**: ✅ Feedback messages use localization keys; no new styling required
- [x] **Localization by Default**: ✅ New key `QuizFuzzyMatchCorrect` added to both English and Korean resource files using `$"{_localize["Key"]}"` pattern
- [x] **Observability**: ✅ Uses `ILogger<VocabularyQuizPage>` for debug/info logging of match decisions
- [x] **Documentation in docs/**: ⚠️ **VIOLATION** - Specs are in `/specs/` not `/docs/specs/`

**Violations requiring justification**: 

**Documentation location** (`/specs/` instead of `/docs/specs/`): The setup script placed files in `/specs/001-fuzzy-text-matching/` directory at repository root. Constitution requires `/docs/` folder. This appears to be a tooling/workflow issue rather than an intentional violation. Recommendation: Either (1) update constitution to recognize `/specs/` as valid, or (2) move all spec directories to `/docs/specs/` and update tooling.

**Status**: ✅ **PASS with documented violation** (tooling/workflow issue, not design issue)

## Project Structure

### Documentation (this feature)

```text
docs/specs/[###-feature]/
├── spec.md              # Feature specification
├── plan.md              # This file (/speckit.plan command output)
├── research.md          # Phase 0 output (/speckit.plan command)
├── data-model.md        # Phase 1 output (/speckit.plan command)
├── quickstart.md        # Phase 1 output (/speckit.plan command)
├── contracts/           # Phase 1 output (/speckit.plan command)
└── tasks.md             # Phase 2 output (/speckit.tasks command - NOT created by /speckit.plan)
```

### Source Code (repository root)

```text
src/
├── SentenceStudio/              # Main MAUI application
│   ├── Pages/                   # MauiReactor page components
│   ├── Services/                # Business logic and AI integration
│   ├── Data/                    # SQLite repositories and models
│   ├── Models/                  # Domain models and DTOs
│   ├── Resources/               # Assets, localization, themes
│   │   ├── Strings/             # Resources.resx, Resources.ko.resx
│   │   └── Styles/              # MyTheme.cs
│   └── Platforms/               # Platform-specific code
├── SentenceStudio.Shared/       # Shared models and utilities
└── SentenceStudio.ServiceDefaults/ # Service configuration

tests/
├── SentenceStudio.Tests/        # Unit tests (xUnit)
└── SentenceStudio.UITests/      # Platform-specific UI tests
```

**Structure Decision**: MAUI multi-platform application with shared business logic and platform-specific implementations. All features must work across iOS, Android, macOS, and Windows.

## Complexity Tracking

✅ **No violations** - This feature adheres to all constitution principles (except documentation location, which is a tooling issue).

No additional complexity introduced:
- Uses existing evaluation patterns in VocabularyQuizPage
- No new dependencies (regex is built into .NET)
- No database changes
- No new UI components
- Reuses existing localization infrastructure
